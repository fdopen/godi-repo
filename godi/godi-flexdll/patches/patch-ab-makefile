--- ./Makefile
+++ ./Makefile
@@ -46,6 +46,7 @@
 MSVCC = $(MSVCC_ROOT)/cl.exe /nologo /MD -D_CRT_SECURE_NO_DEPRECATE /GS-
 MSVCC64 = $(MSVCC_ROOT)/amd64/cl.exe /nologo /MD -D_CRT_SECURE_NO_DEPRECATE /GS-
 OCAMLOPT = ocamlopt
+OCAMLC	 = ocamlc
 #OCAMLOPT = FLEXLINKFLAGS=-real-manifest ocamlopt
 #LINKFLAGS = unix.cmxa
 
@@ -73,9 +74,9 @@
 build_mingw: flexdll_mingw.o flexdll_initer_mingw.o 
 build_mingw64: flexdll_mingw64.o flexdll_initer_mingw64.o
 
-OBJS = version.ml coff.ml cmdline.ml create_dll.ml reloc.ml
+OBJS = version.ml config_reader.ml coff.ml cmdline.ml create_dll.ml reloc.ml
 
-flexlink.exe: $(OBJS) $(RES)
+flexlink.exe: $(OBJS) $(RES) config_reader.cmi
 	@echo Building flexlink.exe with TOOLCHAIN=$(TOOLCHAIN)
 	rm -f flexlink.exe
 	$(OCAMLOPT) -g -w -105 -o flexlink.exe $(LINKFLAGS) $(OBJS)
@@ -83,8 +84,11 @@
 version.res: version.rc
 	rc version.rc
 
+config_reader.cmi:
+	$(OCAMLC) -c config_reader.mli
+
 version_res.o: version.rc
-	windres version.rc version_res.o
+	$(WINDRES) version.rc version_res.o
 
 flexdll_msvc.obj: flexdll.h flexdll.c
 	$(MSVC_PREFIX) $(MSVCC) /DMSVC -c /Fo"flexdll_msvc.obj" flexdll.c
@@ -128,6 +132,7 @@
 flexdll_initer_mingw64.o: flexdll_initer.c
 	$(MIN64CC) -c -o flexdll_initer_mingw64.o flexdll_initer.c
 
+WINDRES ?= windres
 
 demo_msvc: flexlink.exe flexdll_msvc.obj flexdll_initer_msvc.obj
 	(cd test && $(MSVC_PREFIX) $(MAKE) clean demo CHAIN=msvc CC="$(MSVCC)" O=obj)
